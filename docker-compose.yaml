---
version: "3.8"
services:

  service1:

    image: docker.io/joshuahigginson1/melodie_service1:latest

    build:
      context: ./service1

    ports:
      - target: 5001
        published: 5001
        protocol: tcp

    depends_on:
      - service2
      - service3
      - service4

  service2:

    image: docker.io/joshuahigginson1/melodie_service2:latest

    build:
      context: ./service2

    ports:
      - target: 5002
        published: 5002
        protocol: tcp

  service3:

    image: docker.io/joshuahigginson1/melodie_service3:latest

    build:
      context: ./service3

    ports:
      - target: 5003
        published: 5003
        protocol: tcp

  service4:

    image: docker.io/joshuahigginson1/melodie_service4:latest

    build:
      context: ./service4

    ports:
      - target: 5004
        published: 5004
        protocol: tcp
...